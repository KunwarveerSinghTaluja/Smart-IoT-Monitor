<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified IoT Dashboard v1.0</title>

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark-bg: #0f172a;
            --card-bg: #1e293b;
            --border-color: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: #e2e8f0;
            min-height: 100vh;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--card-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); }
            to { transform: translateX(100%); }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        .hidden {
            display: none !important;
        }

        /* Components */
        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.625rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            color: white;
            font-size: 0.875rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.08);
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1.5rem;
        }

        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s ease-out;
        }

        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            min-width: 300px;
            max-width: 400px;
            z-index: 9999;
            animation: slideInRight 0.3s ease-out;
        }

        .notification.exit {
            animation: slideOutRight 0.3s ease-out;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #94a3b8;
            border-bottom: 1px solid var(--border-color);
        }

        .table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-online {
            background: #10b981;
        }

        .status-offline {
            background: #ef4444;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: #94a3b8;
            cursor: pointer;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: white;
        }

        .nav-item.active {
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary);
        }

        .tabs {
            display: flex;
            gap: 1rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1rem;
            cursor: pointer;
            color: #94a3b8;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab:hover {
            color: white;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
    </style>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: 'var(--primary)',
                        secondary: 'var(--secondary)',
                        success: 'var(--success)',
                        warning: 'var(--warning)',
                        danger: 'var(--danger)',
                    }
                }
            }
        }
    </script>
</head>
<body>

<!-- Login Screen -->
<div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
    <div class="card max-w-md w-full">
        <div class="text-center mb-8">
            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl mx-auto mb-4 flex items-center justify-center">
                <span class="material-icons-round text-white text-3xl">dashboard</span>
            </div>
            <h1 class="text-2xl font-bold text-white mb-2">Unified IoT Dashboard</h1>
            <p class="text-gray-400 text-sm">Sign in to your account</p>
        </div>

        <form id="loginForm" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Email / Username</label>
                <input type="text" id="loginUsername" class="form-input" placeholder="Enter your email or username" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password" required>
            </div>
            <div class="flex items-center justify-between">
                <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer">
                    <input type="checkbox" class="rounded">
                    Remember me
                </label>
                <a href="#" class="text-sm text-blue-400 hover:underline">Forgot password?</a>
            </div>
            <button type="submit" class="btn btn-primary w-full">
                <span class="material-icons-round text-sm">login</span>
                Sign In
            </button>
        </form>

        <div class="mt-6 text-center text-sm text-gray-400">
            <p>© 2025 Unified IoT Dashboard v1.0</p>
        </div>
    </div>
</div>

<!-- Main Dashboard -->
<div id="dashboardScreen" class="hidden">
    <!-- Sidebar -->
    <aside class="fixed left-0 top-0 h-screen w-64 bg-card-bg border-r border-border-color z-40">
        <div class="p-6 border-b border-border-color">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                    <span class="material-icons-round text-white">dashboard</span>
                </div>
                <div>
                    <h1 class="text-lg font-bold text-white">IoT Dashboard</h1>
                    <span class="text-xs text-blue-400">v1.0</span>
                </div>
            </div>
        </div>

        <nav class="p-4 space-y-1">
            <div class="nav-item active" onclick="showSection('overview')">
                <span class="material-icons-round">dashboard</span>
                <span>Overview</span>
            </div>
            <div class="nav-item" onclick="showSection('devices')">
                <span class="material-icons-round">devices</span>
                <span>Devices</span>
            </div>
            <div class="nav-item" onclick="showSection('visualization')">
                <span class="material-icons-round">analytics</span>
                <span>Data Visualization</span>
            </div>
            <div class="nav-item" onclick="showSection('alerts')">
                <span class="material-icons-round">notifications</span>
                <span>Alerts</span>
            </div>
            <div class="nav-item" onclick="showSection('users')" id="usersNav">
                <span class="material-icons-round">people</span>
                <span>User Management</span>
            </div>
            <div class="nav-item" onclick="showSection('logs')">
                <span class="material-icons-round">list_alt</span>
                <span>Activity Logs</span>
            </div>
            <div class="nav-item" onclick="showSection('ota')">
                <span class="material-icons-round">system_update</span>
                <span>OTA Updates</span>
            </div>
        </nav>

        <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-border-color">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold">
                    <span id="userInitial">A</span>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="text-sm font-medium text-white truncate" id="userName">Admin User</div>
                    <div class="text-xs text-gray-400" id="userRole">Administrator</div>
                </div>
            </div>
            <button onclick="logout()" class="btn btn-secondary w-full text-sm">
                <span class="material-icons-round text-sm">logout</span>
                Logout
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="ml-64 min-h-screen p-6">
        <!-- Header -->
        <header class="mb-6 flex items-center justify-between">
            <div>
                <h2 class="text-2xl font-bold text-white mb-1" id="sectionTitle">Dashboard Overview</h2>
                <p class="text-gray-400 text-sm" id="sectionSubtitle">Monitor and manage your IoT devices</p>
            </div>
            <div class="flex items-center gap-3">
                <div class="text-sm text-right">
                    <div class="text-white font-medium" id="currentTime">--:--:--</div>
                    <div class="text-gray-400" id="currentDate">Loading...</div>
                </div>
            </div>
        </header>

        <!-- Overview Section -->
        <div id="overviewSection" class="space-y-6">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center">
                            <span class="material-icons-round text-blue-500">devices</span>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-white mb-1" id="totalDevices">0</div>
                    <div class="text-sm text-gray-400">Total Devices</div>
                </div>

                <div class="card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center">
                            <span class="material-icons-round text-green-500">check_circle</span>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-white mb-1" id="onlineDevices">0</div>
                    <div class="text-sm text-gray-400">Online Devices</div>
                </div>

                <div class="card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-yellow-500/20 rounded-lg flex items-center justify-center">
                            <span class="material-icons-round text-yellow-500">warning</span>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-white mb-1" id="activeAlerts">0</div>
                    <div class="text-sm text-gray-400">Active Alerts</div>
                </div>

                <div class="card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center">
                            <span class="material-icons-round text-purple-500">person</span>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-white mb-1" id="totalUsers">0</div>
                    <div class="text-sm text-gray-400">Total Users</div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="card">
                <h3 class="text-lg font-semibold text-white mb-4">Recent Device Activity</h3>
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Device</th>
                            <th>Serial Number</th>
                            <th>Status</th>
                            <th>Last Update</th>
                            <th>Location</th>
                        </tr>
                        </thead>
                        <tbody id="recentActivityTable">
                        <tr>
                            <td colspan="5" class="text-center text-gray-400 py-8">No recent activity</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Devices Section -->
        <div id="devicesSection" class="hidden space-y-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">Device Management</h3>
                    <p class="text-sm text-gray-400">Manage and configure your IoT devices</p>
                </div>
                <button onclick="openAddDeviceModal()" class="btn btn-primary">
                    <span class="material-icons-round text-sm">add</span>
                    Add Device
                </button>
            </div>

            <div class="card">
                <div class="mb-4 flex items-center justify-between">
                    <input type="text" id="deviceSearch" placeholder="Search devices..." class="form-input max-w-xs" onkeyup="filterDevices()">
                    <select id="deviceStatusFilter" class="form-select max-w-xs" onchange="filterDevices()">
                        <option value="all">All Status</option>
                        <option value="online">Online</option>
                        <option value="offline">Offline</option>
                    </select>
                </div>

                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Device Name</th>
                            <th>Serial Number</th>
                            <th>Status</th>
                            <th>Assigned Users</th>
                            <th>Last Seen</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody id="devicesTable">
                        <tr>
                            <td colspan="6" class="text-center text-gray-400 py-8">No devices found</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Data Visualization Section -->
        <div id="visualizationSection" class="hidden space-y-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">Data Visualization</h3>
                    <p class="text-sm text-gray-400">View and analyze device data</p>
                </div>
            </div>

            <!-- Device & Time Range Selection -->
            <div class="card">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Select Device</label>
                        <select id="vizDeviceSelect" class="form-select" onchange="loadVisualizationData()">
                            <option value="">Choose a device...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Time Range</label>
                        <select id="vizTimeRange" class="form-select" onchange="loadVisualizationData()">
                            <option value="1h">Last 1 Hour</option>
                            <option value="24h">Last 24 Hours</option>
                            <option value="7d">Last 7 Days</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">View Type</label>
                        <select id="vizViewType" class="form-select" onchange="switchVisualizationType()">
                            <option value="chart">Graphical</option>
                            <option value="table">Tabular</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Custom Date Range (hidden by default) -->
            <div id="customDateRange" class="card hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Start Date & Time</label>
                        <input type="datetime-local" id="vizStartDate" class="form-input">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">End Date & Time</label>
                        <input type="datetime-local" id="vizEndDate" class="form-input">
                    </div>
                </div>
                <button onclick="loadVisualizationData()" class="btn btn-primary mt-4">
                    <span class="material-icons-round text-sm">search</span>
                    Load Data
                </button>
            </div>

            <!-- Chart View -->
            <div id="chartView" class="card">
                <div class="flex items-center justify-between mb-4">
                    <h4 class="text-lg font-semibold text-white">Device Parameters</h4>
                    <button onclick="downloadCSV()" class="btn btn-secondary text-sm">
                        <span class="material-icons-round text-sm">download</span>
                        Download CSV
                    </button>
                </div>
                <div class="h-96">
                    <canvas id="dataChart"></canvas>
                </div>
            </div>

            <!-- Table View -->
            <div id="tableView" class="card hidden">
                <div class="flex items-center justify-between mb-4">
                    <h4 class="text-lg font-semibold text-white">Device Data Table</h4>
                    <button onclick="downloadCSV()" class="btn btn-secondary text-sm">
                        <span class="material-icons-round text-sm">download</span>
                        Download CSV
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead id="dataTableHead">
                        <tr>
                            <th>Timestamp</th>
                            <th>Parameter</th>
                            <th>Value</th>
                            <th>Unit</th>
                        </tr>
                        </thead>
                        <tbody id="dataTableBody">
                        <tr>
                            <td colspan="4" class="text-center text-gray-400 py-8">No data available</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div id="tablePagination" class="mt-4 flex items-center justify-between">
                    <div class="text-sm text-gray-400">
                        Showing <span id="pageInfo">0-0 of 0</span> entries
                    </div>
                    <div class="flex gap-2">
                        <button onclick="previousPage()" class="btn btn-secondary text-sm">Previous</button>
                        <button onclick="nextPage()" class="btn btn-secondary text-sm">Next</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alerts Section -->
        <div id="alertsSection" class="hidden space-y-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">Alert Management</h3>
                    <p class="text-sm text-gray-400">Configure and monitor device alerts</p>
                </div>
                <button onclick="openConfigureAlertModal()" class="btn btn-primary">
                    <span class="material-icons-round text-sm">add_alert</span>
                    Configure Alert
                </button>
            </div>

            <!-- Alert Configuration List -->
            <div class="card">
                <h4 class="text-lg font-semibold text-white mb-4">Alert Configurations</h4>
                <div class="space-y-3" id="alertConfigList">
                    <p class="text-center text-gray-400 py-8">No alert configurations</p>
                </div>
            </div>

            <!-- Recent Alerts -->
            <div class="card">
                <h4 class="text-lg font-semibold text-white mb-4">Recent Alerts</h4>
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Device</th>
                            <th>Parameter</th>
                            <th>Value</th>
                            <th>Threshold</th>
                            <th>Timestamp</th>
                            <th>Status</th>
                        </tr>
                        </thead>
                        <tbody id="recentAlertsTable">
                        <tr>
                            <td colspan="6" class="text-center text-gray-400 py-8">No recent alerts</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- User Management Section -->
        <div id="usersSection" class="hidden space-y-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">User Management</h3>
                    <p class="text-sm text-gray-400">Manage users and permissions</p>
                </div>
                <button onclick="openAddUserModal()" class="btn btn-primary">
                    <span class="material-icons-round text-sm">person_add</span>
                    Add User
                </button>
            </div>

            <div class="card">
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Devices Assigned</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody id="usersTable">
                        <tr>
                            <td colspan="6" class="text-center text-gray-400 py-8">No users found</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Activity Logs Section -->
        <div id="logsSection" class="hidden space-y-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">Activity Logs</h3>
                    <p class="text-sm text-gray-400">Monitor user login and system activity</p>
                </div>
                <button onclick="exportLogs()" class="btn btn-secondary">
                    <span class="material-icons-round text-sm">download</span>
                    Export Logs
                </button>
            </div>

            <div class="card">
                <div class="mb-4 flex items-center gap-4">
                    <select id="logTypeFilter" class="form-select max-w-xs" onchange="filterLogs()">
                        <option value="all">All Activities</option>
                        <option value="login">Login Activities</option>
                        <option value="device">Device Changes</option>
                        <option value="alert">Alert Activities</option>
                    </select>
                    <input type="date" id="logDateFilter" class="form-input max-w-xs" onchange="filterLogs()">
                </div>

                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>User</th>
                            <th>Activity Type</th>
                            <th>Description</th>
                            <th>IP Address</th>
                            <th>Status</th>
                        </tr>
                        </thead>
                        <tbody id="logsTable">
                        <tr>
                            <td colspan="6" class="text-center text-gray-400 py-8">No logs found</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- OTA Updates Section -->
        <div id="otaSection" class="hidden space-y-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">OTA Firmware Updates</h3>
                    <p class="text-sm text-gray-400">Manage remote firmware updates (Provision Only)</p>
                </div>
            </div>

            <div class="card">
                <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <span class="material-icons-round text-yellow-500">info</span>
                        <div>
                            <h4 class="font-semibold text-yellow-500 mb-1">Provision Only</h4>
                            <p class="text-sm text-gray-300">OTA update functionality is currently in provision mode. Actual firmware update logic will be implemented in future versions.</p>
                        </div>
                    </div>
                </div>

                <form id="otaForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Select Device</label>
                            <select id="otaDeviceSelect" class="form-select" required>
                                <option value="">Choose a device...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Firmware Version</label>
                            <input type="text" id="otaVersion" class="form-input" placeholder="e.g., v2.0.1" required>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Update Source</label>
                        <select id="otaSource" class="form-select" required>
                            <option value="aws">AWS S3</option>
                            <option value="ftp">FTP Server</option>
                            <option value="http">HTTP/HTTPS</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Firmware URL/Path</label>
                        <input type="text" id="otaUrl" class="form-input" placeholder="Enter firmware location" required>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Release Notes</label>
                        <textarea id="otaReleaseNotes" class="form-input" rows="3" placeholder="Describe the changes in this update"></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons-round text-sm">system_update</span>
                        Schedule Update
                    </button>
                </form>
            </div>

            <!-- Update History -->
            <div class="card">
                <h4 class="text-lg font-semibold text-white mb-4">Update History</h4>
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Device</th>
                            <th>Version</th>
                            <th>Source</th>
                            <th>Scheduled Date</th>
                            <th>Status</th>
                        </tr>
                        </thead>
                        <tbody id="otaHistoryTable">
                        <tr>
                            <td colspan="5" class="text-center text-gray-400 py-8">No update history</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Add Device Modal -->
<div id="addDeviceModal" class="modal hidden">
    <div class="modal-content">
        <div class="p-6 border-b border-border-color">
            <div class="flex items-center justify-between">
                <h3 class="text-xl font-bold text-white">Add New Device</h3>
                <button onclick="closeModal('addDeviceModal')" class="text-gray-400 hover:text-white">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
        </div>
        <form id="addDeviceForm" class="p-6 space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Device Name *</label>
                <input type="text" id="deviceName" class="form-input" placeholder="e.g., Temperature Sensor 1" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Serial Number (10 digits) *</label>
                <input type="text" id="deviceSerial" class="form-input" placeholder="e.g., 1234567890" pattern="[0-9]{10}" maxlength="10" required>
                <p class="text-xs text-gray-400 mt-1">Serial number is unique and immutable</p>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Device Type</label>
                <select id="deviceType" class="form-select">
                    <option value="sensor">Sensor</option>
                    <option value="actuator">Actuator</option>
                    <option value="gateway">Gateway</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Location</label>
                <input type="text" id="deviceLocation" class="form-input" placeholder="e.g., Building A, Floor 2">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Assign to Users</label>
                <select id="deviceUsers" class="form-select" multiple size="3">
                    <!-- Will be populated dynamically -->
                </select>
                <p class="text-xs text-gray-400 mt-1">Hold Ctrl/Cmd to select multiple</p>
            </div>
            <div>
                <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                    <input type="checkbox" id="deviceEnabled" checked>
                    <span>Enable device</span>
                </label>
            </div>
            <div class="flex gap-3 pt-4">
                <button type="submit" class="btn btn-primary flex-1">
                    <span class="material-icons-round text-sm">add</span>
                    Add Device
                </button>
                <button type="button" onclick="closeModal('addDeviceModal')" class="btn btn-secondary flex-1">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Configure Parameters Modal -->
<div id="configureParamsModal" class="modal hidden">
    <div class="modal-content">
        <div class="p-6 border-b border-border-color">
            <div class="flex items-center justify-between">
                <h3 class="text-xl font-bold text-white">Configure Device Parameters</h3>
                <button onclick="closeModal('configureParamsModal')" class="text-gray-400 hover:text-white">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="font-semibold text-white mb-2">Device: <span id="configDeviceName"></span></h4>
                <p class="text-sm text-gray-400">Serial: <span id="configDeviceSerial"></span></p>
            </div>

            <!-- Existing Parameters -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-white mb-3">Configured Parameters</h4>
                <div id="existingParamsList" class="space-y-2">
                    <p class="text-sm text-gray-400">No parameters configured yet</p>
                </div>
            </div>

            <!-- Add New Parameter -->
            <div class="border-t border-border-color pt-6">
                <h4 class="text-sm font-semibold text-white mb-4">Add New Parameter</h4>
                <form id="addParamForm" class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Parameter Name *</label>
                            <input type="text" id="paramName" class="form-input" placeholder="e.g., Temperature" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Unit *</label>
                            <input type="text" id="paramUnit" class="form-input" placeholder="e.g., °C, %, V" required>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Data Type *</label>
                            <select id="paramDataType" class="form-select" required>
                                <option value="boolean">Boolean</option>
                                <option value="integer">Integer</option>
                                <option value="unsigned">Unsigned Integer</option>
                                <option value="float">Float</option>
                                <option value="sfloat">Short Float</option>
                            </select>
                        </div>
                        <div>
                            <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer mt-8">
                                <input type="checkbox" id="paramLocked">
                                <span>Lock from sub-user editing</span>
                            </label>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Min Value (optional)</label>
                            <input type="number" id="paramMin" class="form-input" step="any">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Max Value (optional)</label>
                            <input type="number" id="paramMax" class="form-input" step="any">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons-round text-sm">add</span>
                        Add Parameter
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Configure Alert Modal -->
<div id="configureAlertModal" class="modal hidden">
    <div class="modal-content">
        <div class="p-6 border-b border-border-color">
            <div class="flex items-center justify-between">
                <h3 class="text-xl font-bold text-white">Configure Alert</h3>
                <button onclick="closeModal('configureAlertModal')" class="text-gray-400 hover:text-white">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
        </div>
        <form id="configureAlertForm" class="p-6 space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Device *</label>
                <select id="alertDevice" class="form-select" required onchange="loadDeviceParameters()">
                    <option value="">Select device...</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Parameter *</label>
                <select id="alertParameter" class="form-select" required>
                    <option value="">Select parameter...</option>
                </select>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Lower Threshold</label>
                    <input type="number" id="alertLowerThreshold" class="form-input" step="any">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Upper Threshold</label>
                    <input type="number" id="alertUpperThreshold" class="form-input" step="any">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Notification Methods</label>
                <div class="space-y-2">
                    <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" id="alertEmail" checked>
                        <span>Email Alert</span>
                    </label>
                    <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" id="alertSMS">
                        <span>SMS Alert (Provision)</span>
                    </label>
                </div>
            </div>
            <div>
                <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                    <input type="checkbox" id="alertEnabled" checked>
                    <span>Enable Alert</span>
                </label>
            </div>
            <div class="flex gap-3 pt-4">
                <button type="submit" class="btn btn-primary flex-1">
                    <span class="material-icons-round text-sm">save</span>
                    Save Alert
                </button>
                <button type="button" onclick="closeModal('configureAlertModal')" class="btn btn-secondary flex-1">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Add User Modal -->
<div id="addUserModal" class="modal hidden">
    <div class="modal-content">
        <div class="p-6 border-b border-border-color">
            <div class="flex items-center justify-between">
                <h3 class="text-xl font-bold text-white">Add New User</h3>
                <button onclick="closeModal('addUserModal')" class="text-gray-400 hover:text-white">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
        </div>
        <form id="addUserForm" class="p-6 space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Full Name *</label>
                <input type="text" id="userFullName" class="form-input" placeholder="Enter full name" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Email *</label>
                <input type="email" id="userEmail" class="form-input" placeholder="user@example.com" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Password *</label>
                <input type="password" id="userPassword" class="form-input" placeholder="Minimum 8 characters" minlength="8" required>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Role *</label>
                <select id="userRole" class="form-select" required>
                    <option value="sub-user">Sub-User</option>
                    <option value="admin">Administrator</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Assign Devices</label>
                <select id="userDevices" class="form-select" multiple size="4">
                    <!-- Will be populated dynamically -->
                </select>
                <p class="text-xs text-gray-400 mt-1">Hold Ctrl/Cmd to select multiple</p>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Permissions</label>
                <div class="space-y-2">
                    <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" id="permViewDevices" checked disabled>
                        <span>View assigned devices</span>
                    </label>
                    <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" id="permEditConfig">
                        <span>Edit device configuration</span>
                    </label>
                    <label class="flex items-center gap-2 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" id="permManageUsers">
                        <span>Manage users (Admin only)</span>
                    </label>
                </div>
            </div>
            <div class="flex gap-3 pt-4">
                <button type="submit" class="btn btn-primary flex-1">
                    <span class="material-icons-round text-sm">person_add</span>
                    Add User
                </button>
                <button type="button" onclick="closeModal('addUserModal')" class="btn btn-secondary flex-1">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Notification Container -->
<div id="notificationContainer"></div>

<script src="app.js"></script>
</body>
</html>